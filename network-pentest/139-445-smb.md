# 139,445 - SMB

SMB ports are used for file sharing and other network functions. The Server Message Block (SMB)

* Port 139: Used by SMB dialects that communicate over NetBIOS. NetBIOS is an older transport layer that allows Windows computers to talk to each other on the same network.
* Port 445: Used by later versions of SMB.

<pre class="language-bash"><code class="lang-bash">smbclient -L \\\\192.168.X.30\\
<strong>|
</strong>smbclient \\\\$ip_address\\ADMIN$ 
>help
>get
</code></pre>

\-L -> list all the files shared.

```bash
smbclient -U user%password //10.10.10.100/Users
```

* /users -> Which folder to go

## SmbMap

```bash
smbmap -H <IP> [-P <PORT>] #Null user
smbmap -u "username" -p "password" -H <IP> [-P <PORT>] #Creds
smbmap -u "username" -p "<NT>:<LM>" -H <IP> [-P <PORT>] #Pass-the-Hash

#List with smbmap, without folder it list everything
smbmap [-u "username" -p "password"] -R [Folder] -H <IP> [-P <PORT>] # Recursive list
```

### **Download files**

Read previous sections to learn how to connect with credentials/Pass-the-Hash.

```bash
#Search a file -R recursive -q Download
smbmap -R Folder -H <IP> -A <FileName> -q 
```

```bash
#Download all
smbclient //<IP>/<share>
> mask ""
> recurse ON
> prompt OFF
> mget *
#Download everything to current directory
```
